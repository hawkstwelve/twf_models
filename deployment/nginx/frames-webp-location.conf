# Insert this location block inside the `server { ... }` block that serves api.sodakweather.com.
# Place it before generic proxy/static handlers so `/frames/...` resolves directly to published artifacts.
location ~ ^/frames/(?<model>[a-z0-9_-]+)/(?<run>\d{8}_\d{2}z)/(?<var>[a-z0-9_-]+)/(?<fh>\d{3})\.webp$ {
    alias /data/published/$model/$run/$var/frames/$fh.webp;
    default_type image/webp;
    add_header Cache-Control "public, max-age=31536000, immutable" always;
    add_header Access-Control-Allow-Origin "*" always;
    add_header Cross-Origin-Resource-Policy "cross-origin" always;
}
